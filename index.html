<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Социален компас</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="manifest" href="manifest.webmanifest">
    <style>
        body { background-color: #f8f8f8; color: #22c55e; }
        .hidden { display: none; }
        #timer { color: #1a1a1a; }
    </style>
</head>
<body class="p-5 font-sans">
    <div class="max-w-md mx-auto bg-white p-6 rounded-xl shadow-lg">
        <div id="motto-display" class="text-center italic font-bold mb-6 min-h-[4rem] text-green-700 flex items-center justify-center border-b pb-4">
            Зареждане на мото...
        </div>

        <div class="text-center mb-6">
            <h2 class="text-xl font-bold mb-2 uppercase tracking-tighter">Крузо аларм</h2>
            <div id="timer" class="text-6xl font-mono mb-4">01:00</div>
            
            <div class="grid grid-cols-2 gap-2 text-sm font-bold bg-gray-100 p-3 rounded-lg mb-4">
                <div class="text-red-600">Кортизол: <span id="cortisol">0</span></div>
                <div class="text-blue-600">Ендорфини: <span id="endorphins">0</span></div>
            </div>
            
            <button id="start-btn" onclick="startApp()" class="bg-green-600 hover:bg-green-700 text-white px-10 py-4 rounded-full font-black text-xl shadow-lg transition-transform active:scale-95">
                СТАРТ
            </button>
        </div>

        <div id="mission-panel" class="hidden border-t-2 border-red-200 pt-4 bg-red-50 p-4 rounded-lg">
            <h3 class="text-lg font-black mb-2 text-red-600 uppercase">⚠️ Survival Mission</h3>
            <div id="mission-text" class="mb-4 text-gray-800 font-bold text-lg"></div>
            <button onclick="completeMission()" class="bg-blue-600 hover:bg-blue-700 text-white w-full py-4 rounded-xl font-bold text-lg shadow-md uppercase">
                Изпълних мисията
            </button>
            <button onclick="showEthicalFilter()" class="mt-3 text-gray-500 text-xs w-full underline">
                Отказвам (Етичен филтър)
            </button>
        </div>

        <div id="ethical-filter" class="hidden border-t mt-4 pt-4 bg-yellow-50 p-4 rounded-lg border border-yellow-200">
            <h3 class="font-bold mb-3 text-yellow-900 underline uppercase text-sm">Етичен казус: Адам Рейн</h3>
            <div class="space-y-3">
                <label class="flex items-start text-xs font-medium text-yellow-900">
                    <input type="checkbox" class="ethical-check mt-1 mr-2"> 
                    Предпочитате ли подкрепа от AI пред разговор с реален човек?
                </label>
                <label class="flex items-start text-xs font-medium text-yellow-900">
                    <input type="checkbox" class="ethical-check mt-1 mr-2"> 
                    Бягате ли от физическите проблеми чрез дигиталния свят?
                </label>
                <label class="flex items-start text-xs font-medium text-yellow-900">
                    <input type="checkbox" class="ethical-check mt-1 mr-2"> 
                    Пренебрегвате ли тялото си заради време пред екрана?
                </label>
            </div>
            <button onclick="checkEthics()" class="mt-4 bg-gray-900 text-white w-full py-3 rounded-lg font-bold uppercase text-sm">
                Провери риска
            </button>
        </div>

        <div id="crisis-panel" class="hidden mt-4 p-4 bg-red-700 text-white rounded-lg animate-bounce">
            <h3 class="font-bold text-center border-b border-red-500 pb-2 mb-2 uppercase">Висок риск!</h3>
            <p class="text-xs text-center mb-1">Национална линия за деца: <strong>116 111</strong></p>
            <p class="text-xs text-center">Помощ при насилие: <strong>0800 11 977</strong></p>
        </div>
    </div>

    <script>
        // ДАННИ ОТ ПРОЕКТА
        const mottos = [
            "Мързелът няма да те доведе до никъде.",
            "Светът е отвън, не в екрана.",
            "Говори с хора, а не с телефона.",
            "Движението е лекът на живота.",
            "Дори и най-малката вяра може да ти помогне в трудни дни."
        ];

        const missions = [
            { name: "Клекове", desc: "60 клека до долу с изпънати ръце" },
            { name: "Jumping Jacks", desc: "40 повторения с бързо темпо" },
            { name: "Планк", desc: "2 минути на лакти, тялото право" },
            { name: "Тичане", desc: "Бягане на място с високо вдигнати колена" }
        ];

        let cortisol = 0, endorphins = 0;
        let timerSeconds = 60; // 1 минута за тест
        let interval;

        // РОТАЦИЯ НА МОТОТА
        let mIdx = 0;
        function rotateMotto() {
            document.getElementById('motto-display').innerText = mottos[mIdx];
            mIdx = (mIdx + 1) % mottos.length;
        }
        setInterval(rotateMotto, 5000);
        rotateMotto();

        // СТАРТИРАНЕ
        function startApp() {
            // СКРИВАМЕ БУТОНА ВЕДНАГА
            document.getElementById('start-btn').classList.add('hidden');
            
            interval = setInterval(() => {
                timerSeconds--;
                
                // Вдигане на стреса на всеки 10 секунди (за теста)
                if (timerSeconds % 10 === 0 && timerSeconds > 0) {
                    cortisol += 5;
                    updateStats();
                }

                updateDisplay();

                if (timerSeconds <= 0) {
                    clearInterval(interval);
                    showMission();
                }
            }, 1000);
        }

        function updateDisplay() {
            let m = Math.floor(timerSeconds / 60);
            let s = timerSeconds % 60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
        }

        function updateStats() {
            document.getElementById('cortisol').innerText = cortisol;
            document.getElementById('endorphins').innerText = endorphins;
        }

        function showMission() {
            const m = missions[Math.floor(Math.random() * missions.length)];
            document.getElementById('mission-text').innerHTML = `${m.name}: ${m.desc}`;
            document.getElementById('mission-panel').classList.remove('hidden');
        }

        function completeMission() {
            cortisol -= 15;
            endorphins += 20;
            updateStats();
            alert("Поздравления! Стресът намаля.");
            reset();
        }

        function showEthicalFilter() {
            document.getElementById('ethical-filter').classList.remove('hidden');
        }

        function checkEthics() {
            const checked = document.querySelectorAll('.ethical-check:checked').length;
            if (checked >= 2) {
                document.getElementById('crisis-panel').classList.remove('hidden');
                alert("ВНИМАНИЕ: Засечен е етичен риск! Изпълнете мисията веднага.");
            } else {
                alert("Рискът е нисък, но тялото ти има нужда от движение.");
                reset();
            }
        }

        function reset() {
            clearInterval(interval);
            timerSeconds = 3000; // Връщаме на 50 минути за реална работа
            updateDisplay();
            document.getElementById('start-btn').classList.remove('hidden');
            document.getElementById('mission-panel').classList.add('hidden');
            document.getElementById('ethical-filter').classList.add('hidden');
            document.getElementById('crisis-panel').classList.add('hidden');
            // Нулираме отметките
            document.querySelectorAll('.ethical-check').forEach(c => c.checked = false);
        }
    </script>
</body>
</html>
