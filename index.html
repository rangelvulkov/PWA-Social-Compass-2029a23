<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ—Ü–∏–∞–ª–µ–Ω –∫–æ–º–ø–∞—Å: –†–æ–±–∏–Ω–∑–æ–Ω –ö—Ä—É–∑–æ –∏ AI</title>
    <link rel="manifest" href="manifest.webmanifest">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
        body { font-family: 'Montserrat', sans-serif; background-color: #f8f8f8; }
        .modal { background: rgba(0,0,0,0.85); display: none; position: fixed; inset: 0; z-index: 50; align-items: center; justify-content: center; padding: 20px; }
        .active-modal { display: flex; }
    </style>
</head>
<body class="flex flex-col min-h-screen border-t-8 border-green-500">

    <header class="bg-white shadow-sm p-4 text-center">
        <div id="motto-container" class="text-green-700 italic font-medium min-h-[3rem] flex items-center justify-center transition-opacity duration-500">
            –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –≤–¥—ä—Ö–Ω–æ–≤–µ–Ω–∏–µ...
        </div>
    </header>

    <main class="flex-grow p-6 max-w-md mx-auto w-full space-y-6">
        <div class="grid grid-cols-2 gap-4">
            <div class="bg-white p-4 rounded-2xl shadow-md border-b-4 border-red-400 text-center">
                <p class="text-xs text-gray-500 uppercase font-bold">–ö–æ—Ä—Ç–∏–∑–æ–ª</p>
                <p id="cortisol-val" class="text-3xl font-bold text-red-600">20</p>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-md border-b-4 border-blue-400 text-center">
                <p class="text-xs text-gray-500 uppercase font-bold">–ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏</p>
                <p id="endorphin-val" class="text-3xl font-bold text-blue-600">80</p>
            </div>
        </div>

        <div class="bg-white p-8 rounded-3xl shadow-xl text-center space-y-4">
            <h2 class="text-gray-400 text-sm font-bold tracking-widest uppercase">–ö—Ä—É–∑–æ –∞–ª–∞—Ä–º</h2>
            <div id="timer-display" class="text-6xl font-black text-gray-800 tracking-tighter">00:00</div>
            <div id="total-time" class="text-xs text-gray-400">–û–±—â–æ –ø—Ä–µ–¥ –µ–∫—Ä–∞–Ω–∞: 0 –º–∏–Ω</div>
            
            <button id="mainBtn" onclick="toggleTimer()" class="w-full bg-green-500 hover:bg-green-600 text-white font-black py-4 rounded-2xl shadow-lg transition-all transform active:scale-95">
                –°–¢–ê–†–¢
            </button>
        </div>
    </main>

    <audio id="alarm-sound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <div id="mission-modal" class="modal">
        <div class="bg-white rounded-3xl p-8 max-w-xs w-full text-center space-y-6">
            <div class="text-red-500 text-5xl">‚è∞</div>
            <h2 class="text-2xl font-black text-gray-800">–í–†–ï–ú–ï–¢–û –ò–ó–¢–ï–ß–ï!</h2>
            <p id="mission-text" class="text-gray-600 font-medium">–î–æ—Å—Ç–∏–≥–Ω–∞—Ö—Ç–µ –ø—Ä–∞–≥–∞ –æ—Ç 50 –º–∏–Ω—É—Ç–∏. –ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ –º–∏—Å–∏—è –∑–∞ –±–∞–ª–∞–Ω—Å.</p>
            <div class="space-y-3">
                <button onclick="generateMission()" id="gen-mission-btn" class="w-full bg-blue-500 text-white py-3 rounded-xl font-bold">–ì–ï–ù–ï–†–ò–†–ê–ô –ú–ò–°–ò–Ø</button>
                <button onclick="completeMission()" id="done-mission-btn" class="hidden w-full bg-green-500 text-white py-3 rounded-xl font-bold">–ú–ò–°–ò–Ø–¢–ê –ï –ò–ó–ü–™–õ–ù–ï–ù–ê</button>
                <button onclick="refuseMission()" class="w-full bg-gray-100 text-gray-400 py-2 rounded-xl text-sm font-bold">–û–¢–ö–ê–ó–í–ê–ú</button>
            </div>
        </div>
    </div>

    <div id="ethics-modal" class="modal">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full space-y-6">
            <h2 class="text-xl font-black text-purple-700">–ï—Ç–∏—á–µ–Ω —Ñ–∏–ª—Ç—ä—Ä</h2>
            <div id="ethics-questions" class="space-y-4">
                <div class="space-y-2">
                    <p class="text-sm font-bold">1. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç–µ –ª–∏ –¥–∞ —Ç—ä—Ä—Å–∏—Ç–µ –ø–æ–¥–∫—Ä–µ–ø–∞ –æ—Ç AI, –≤–º–µ—Å—Ç–æ –¥–∞ –≥–æ–≤–æ—Ä–∏—Ç–µ —Å –¥—Ä—É–≥–∏ —Ö–æ—Ä–∞? [cite: 1]</p>
                    <div class="flex gap-4"><label><input type="radio" name="q1" value="yes"> –î–∞</label><label><input type="radio" name="q1" value="no"> –ù–µ</label></div>
                </div>
                <div class="space-y-2">
                    <p class="text-sm font-bold">2. –ß—Ä–µ–∑ –∏–∑–∫—É—Å—Ç–≤–µ–Ω–∏—è –∏–Ω—Ç–µ–ª–µ–∫—Ç –º–æ–∂–µ–º –ª–∏ –¥–∞ –∏–∑–±—è–≥–∞–º–µ –æ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ç–µ —Å–∏ –ø—Ä–æ–±–ª–µ–º–∏? [cite: 1]</p>
                    <div class="flex gap-4"><label><input type="radio" name="q2" value="yes"> –î–∞</label><label><input type="radio" name="q2" value="no"> –ù–µ</label></div>
                </div>
                <div class="space-y-2">
                    <p class="text-sm font-bold">3. –ü—Ä–µ–Ω–µ–±—Ä–µ–≥–≤–∞—Ç–µ –ª–∏ –æ—Å–Ω–æ–≤–Ω–∏—Ç–µ —Å–∏ –Ω—É–∂–¥–∏, –∑–∞ –¥–∞ –ø—Ä–µ–∫–∞—Ä–∞—Ç–µ –ø–æ–≤–µ—á–µ –≤—Ä–µ–º–µ –Ω–∞ –µ–∫—Ä–∞–Ω–∞? [cite: 1]</p>
                    <div class="flex gap-4"><label><input type="radio" name="q3" value="yes"> –î–∞</label><label><input type="radio" name="q3" value="no"> –ù–µ</label></div>
                </div>
                <button onclick="processEthics()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-bold">–ü–†–û–í–ï–†–ò –†–ï–ó–£–õ–¢–ê–¢–ê</button>
            </div>

            <div id="crisis-panel" class="hidden space-y-4 animate-pulse">
                <div class="p-4 bg-red-50 border-2 border-red-200 rounded-2xl text-center">
                    <p class="text-red-600 font-black">–í–ò–°–û–ö –†–ò–°–ö –û–¢ –ó–ê–í–ò–°–ò–ú–û–°–¢!</p>
                    <div class="mt-4 space-y-2 text-sm">
                        <p>üìû –ù–∞—Ü–∏–æ–Ω–∞–ª–Ω–∞ –ª–∏–Ω–∏—è: <strong>116 111</strong> [cite: 1]</p>
                        <p>üìû –î–æ–º–∞—à–Ω–æ –Ω–∞—Å–∏–ª–∏–µ: <strong>0800 11 977</strong> [cite: 1]</p>
                    </div>
                </div>
                <button onclick="returnToMission()" class="w-full bg-gray-800 text-white py-3 rounded-xl font-bold">–í–™–†–ù–ò –°–ï –ö–™–ú –§–í–° –ú–ò–°–ò–Ø</button>
            </div>
        </div>
    </div>

    <script>
        // –î–ê–ù–ù–ò –û–¢ –§–û–†–ú–£–õ–Ø–†–ê [cite: 1]
        const MOTTOES = ["–ú—ä—Ä–∑–µ–ª—ä—Ç –Ω—è–º–∞ –¥–∞ —Ç–µ –¥–æ–≤–µ–¥–µ –¥–æ –Ω–∏–∫—ä–¥–µ.", "–°–≤–µ—Ç—ä—Ç –µ –æ—Ç–≤—ä–Ω, –Ω–µ –≤ –µ–∫—Ä–∞–Ω–∞.", "–ì–æ–≤–æ—Ä–∏ —Å —Ö–æ—Ä–∞, –∞ –Ω–µ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞.", "–î–≤–∏–∂–µ–Ω–∏–µ—Ç–æ –µ –ª–µ–∫—ä—Ç –Ω–∞ –∂–∏–≤–æ—Ç–∞.", "–î–æ—Ä–∏ –∏ –Ω–∞–π-–º–∞–ª–∫–∞—Ç–∞ –≤—è—Ä–∞, –º–æ–∂–µ –¥–∞ —Ç–∏ –ø–æ–º–æ–≥–Ω–µ –≤ –Ω–∞–π-—Ç—Ä—É–¥–Ω–∏—Ç–µ —Ç–∏ –¥–Ω–∏."];
        const MISSIONS = [
            { name: "–ö–ª–µ–∫–æ–≤–µ", text: "60 –∫–ª–µ–∫–∞ –¥–æ –¥–æ–ª—É —Å –∏–∑–ø—ä–Ω–∞—Ç–∏ —Ä—ä—Ü–µ" },
            { name: "Jumping Jacks", text: "30 –¥–æ 40 –ø–æ–¥—Å–∫–æ–∫–∞, –±—ä—Ä–∑–æ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ" },
            { name: "–ë–∞–≤–Ω–æ —Ç–∏—á–∞–Ω–µ", text: "5 –∫–º –¥–∂–æ–≥–∏–Ω–≥" },
            { name: "–ü–ª–∞–Ω–∫", text: "2 –º–∏–Ω. –ø–ª–∞–Ω–∫ –Ω–∞ –ª–∞–∫—Ç–∏, –∏–∑–ø—ä–Ω–∞—Ç–æ —Ç—è–ª–æ" }
        ];

        let cortisol = 20, endorphins = 80, sessionSeconds = 0, totalSeconds = 0;
        let isRunning = false, timerInterval;
        const ALARM_THRESHOLD = 50 * 60; // 50 –º–∏–Ω—É—Ç–∏ [cite: 1]

        // –†–æ—Ç–∞—Ü–∏—è –Ω–∞ –º–æ—Ç–æ—Ç–∞ 
        let mottoIdx = 0;
        function rotateMotto() {
            const el = document.getElementById('motto-container');
            el.style.opacity = 0;
            setTimeout(() => {
                el.innerText = MOTTOES[mottoIdx];
                el.style.opacity = 1;
                mottoIdx = (mottoIdx + 1) % MOTTOES.length;
            }, 500);
        }
        setInterval(rotateMotto, 5000);
        rotateMotto();

        function toggleTimer() {
            const btn = document.getElementById('mainBtn');
            if (!isRunning) {
                isRunning = true;
                btn.innerText = "–°–¢–û–ü";
                btn.className = "w-full bg-red-500 text-white font-black py-4 rounded-2xl shadow-lg transition-all";
                const lastTime = Date.now();
                timerInterval = setInterval(() => {
                    sessionSeconds++;
                    totalSeconds++;
                    updateUI();
                    
                    // –õ–æ–≥–∏–∫–∞ –Ω–∞ –≤—Å–µ–∫–∏ 5 –º–∏–Ω—É—Ç–∏ (300 —Å–µ–∫) 
                    if (sessionSeconds % 300 === 0) {
                        cortisol += 5;
                        endorphins -= 5;
                        updateUI();
                    }

                    if (sessionSeconds >= ALARM_THRESHOLD) {
                        triggerAlarm();
                    }
                }, 1000);
            } else {
                stopTimer();
            }
        }

        function stopTimer() {
            isRunning = false;
            clearInterval(timerInterval);
            const btn = document.getElementById('mainBtn');
            btn.innerText = "–°–¢–ê–†–¢";
            btn.className = "w-full bg-green-500 text-white font-black py-4 rounded-2xl shadow-lg transition-all";
        }

        function updateUI() {
            const m = Math.floor(sessionSeconds / 60), s = sessionSeconds % 60;
            document.getElementById('timer-display').innerText = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            document.getElementById('total-time').innerText = `–û–±—â–æ –ø—Ä–µ–¥ –µ–∫—Ä–∞–Ω–∞: ${Math.floor(totalSeconds / 60)} –º–∏–Ω`;
            document.getElementById('cortisol-val').innerText = cortisol;
            document.getElementById('endorphin-val').innerText = endorphins;
        }

        function triggerAlarm() {
            stopTimer();
            document.getElementById('alarm-sound').play();
            document.getElementById('mission-modal').classList.add('active-modal');
        }

        function generateMission() {
            const mission = MISSIONS[Math.floor(Math.random() * MISSIONS.length)];
            document.getElementById('mission-text').innerHTML = `<strong class="text-blue-600">${mission.name}</strong><br>${mission.text}`;
            document.getElementById('gen-mission-btn').classList.add('hidden');
            document.getElementById('done-mission-btn').classList.remove('hidden');
        }

        function completeMission() {
            // –ö–æ—Ä–µ–∫—Ü–∏—è –Ω–∞ —Ö–æ—Ä–º–æ–Ω–∏ [cite: 1]
            cortisol -= 5; 
            endorphins += 25;
            sessionSeconds = 0;
            updateUI();
            document.getElementById('mission-modal').classList.remove('active-modal');
            alert("–ö–æ—Ä—Ç–∏–∑–æ–ª—ä—Ç –µ –Ω–∞–º–∞–ª–µ–Ω (-5), –ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏—Ç–µ —Å–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏ (+25)! [cite: 1]");
            resetMissionModal();
        }

        function resetMissionModal() {
            document.getElementById('gen-mission-btn').classList.remove('hidden');
            document.getElementById('done-mission-btn').classList.add('hidden');
            document.getElementById('mission-text').innerText = "–î–æ—Å—Ç–∏–≥–Ω–∞—Ö—Ç–µ –ø—Ä–∞–≥–∞ –æ—Ç 50 –º–∏–Ω—É—Ç–∏. –ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ –º–∏—Å–∏—è –∑–∞ –±–∞–ª–∞–Ω—Å.";
        }

        function refuseMission() {
            document.getElementById('mission-modal').classList.remove('active-modal');
            document.getElementById('ethics-modal').classList.add('active-modal');
        }

        function processEthics() {
            const answers = document.querySelectorAll('input[type="radio"]:checked');
            if (answers.length < 3) return alert("–ú–æ–ª—è –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ –Ω–∞ –≤—Å–∏—á–∫–∏ –≤—ä–ø—Ä–æ—Å–∏!");
            
            const yesCount = Array.from(answers).filter(a => a.value === 'yes').length;
            if (yesCount >= 2) {
                document.getElementById('ethics-questions').classList.add('hidden');
                document.getElementById('crisis-panel').classList.remove('hidden');
            } else {
                alert("–ü–æ–µ–ª–∏ —Å—Ç–µ –º–∞–ª—ä–∫ —Ä–∏—Å–∫. –í—ä—Ä–Ω–µ—Ç–µ —Å–µ –∫—ä–º —Ñ–∏–∑–∏—á–µ—Å–∫–∞—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç!");
                returnToMission();
            }
        }

        function returnToMission() {
            document.getElementById('ethics-modal').classList.remove('active-modal');
            document.getElementById('ethics-questions').classList.remove('hidden');
            document.getElementById('crisis-panel').classList.add('hidden');
            document.getElementById('mission-modal').classList.add('active-modal');
        }

        // –ü–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ —Ñ–æ–Ω–æ–≤ —Ä–µ–∂–∏–º (–ø—Ä–µ–∏–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –ø—Ä–∏ –≤—Ä—ä—â–∞–Ω–µ –≤ —Ç–∞–±–∞) 
        let lastTimestamp = Date.now();
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                lastTimestamp = Date.now();
            } else if (isRunning) {
                const elapsed = Math.floor((Date.now() - lastTimestamp) / 1000);
                sessionSeconds += elapsed;
                totalSeconds += elapsed;
                updateUI();
            }
        });
    </script>
</body>
</html>
